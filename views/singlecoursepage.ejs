<!doctype html>
<html lang="en">
<title>MSEP</title>

<!-- <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.3/css/jquery.dataTables.css"> -->
<link href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<link rel="stylesheet" href="http://cdn.datatables.net/1.10.2/css/jquery.dataTables.min.css">
<script type="text/javascript" src="http://cdn.datatables.net/1.10.2/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

<body>
    <div style="text-align: center;">
        <h1>Course Page</h1>
    </div>
    <hr>
    <div style="margin-left: 50px;">
        <h2>Course </h2>
        <% if(course!=null) { %>
            <div> This is a single course page
                <h1>
                    <%=course.name%>
                </h1>
                <p>Code &emsp;&emsp;&emsp;&emsp;&emsp;: <%=course.code%>
                </p>
                <p>Instructor &emsp;&emsp;&emsp; : <%=course.instructor%>
                </p>
                <br>
                <label style="color: brown;">Offline</label>
                <div id="covid-acknowlegde">
                    <p>Click below if you want to opt out from attending offline class.</p>
                    <label style="color: blue;">Opt out</label><input type="checkbox" value="Opt out"
                        onclick='unbookSeat("<%=course.code%>")'><br>
                </div>
                <% } %>
                    <br><label style="color: brown;">Online</label>
                    <div id="onlinecheck">
                        <br>Meetlink for online class of <%=course.name%> is : <p style="color: blue;">
                                <%=course.meetlink%>
                            </p>
                    </div>
            </div>
    </div>

    <div style="margin-left: 50px;">
        <h3>Assignments for you!</h3>
        <table id="submitAssign" class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Description</th>
                    <th>Due Date</th>
                    <th>Question Paper</th>
                    <th>Select Submission</th>
                    <th>Add submission</th>
                    <th>Your submission</th>
                    <th>Grade</th>
                </tr>
            </thead>
            <tbody>
                <% course.assignment.forEach(function(item){%>
                    <tr>
                        <td>
                            <%= item.title%>
                        </td>
                        <td>
                            <%= item.description%>
                        </td>
                        <td>
                            <%= item.deadline%>
                        </td>
                        <td>
                            <a href='uploads/<%=item.file%>'>Show file</a>
                            <!-- file -->
                        </td>
                        <td>
                            <!-- submission -->
                            <form method="post" action="/submitAssign" enctype="multipart/form-data">
                                <input type="text" name="scourse" value="<%=course.code%>"
                                    placeholder="<%=course.code%>" hidden>
                                <input type="text" name="assignCode" value="<%=item.title%>"
                                    placeholder="<%=item.title%>" hidden>
                                <!-- <input type="file" name="submission" value="submit"> -->
                                <input type="file" name="submission" placeholder="submissionlink" id="<%=item.title%>"
                                    required>
                        </td>
                        <td>
                            <input type="submit" value="turn in">

                        </td>
                        <td>
                            <% if(item.submission){item.submission.forEach(function(val){ if(val.name==user.name){%>
                                <script>document.getElementById("<%=item.title%>").disabled = true;</script>
                                <a href="uploads/<%=val.filename%>" target="_blank">submission</a>
                        </td>
                        <td>
                            <%if(val.grade){%>
                                <%=val.grade%>
                            <%} else{%>
                                <%="--"%>
                            <%}%>
                        </td>
                        <%} })}%>

                            </form>
                    </tr>
                    <% }) %>
            </tbody>
        </table>
    </div>
</body>
<script>
    function unbookSeat(code) {
        $.get(
            "unbookseat",
            { code: code },
            function (data) {
                alert(data);
            }
        );
    }

    // $('#acknowledgement').change(function () {
    //     $('#covid-acknowlegde').toggle();
    // });
    // $('#class-meetlink').change(function () {
    //     $('#onlinecheck').toggle();
    // });
</script>